!function(a){"use strict";(a.eis||(a.eis={})).CONFIG={module:"eis",title:"EFV-EIS - PROTOTYPE",description:"Electronic information system for the Swiss federal budget.",home:"#/home",locales:["de","fr","it","en"],defaults:{locale:"de",state:"home",layout:"default",http:{timeout:1e4}},api:{schema:"http",hostname:"localhost",port:8080,context:"/oblique-reactive/api",logs:"/logs",sendCredentials:!1}}}(window),function(){"use strict";angular.module("eis",["ngCookies","ui.bootstrap","ngSanitize","ui.router","ui.slider","pascalprecht.translate","chart.js","RecursionHelper","zeroclipboard","eis.app-templates","eis.oblique","eis.common","eis.charts","eis.home","eis.generalBudget","eis.expenses","eis.revenue","eis.institutions"]).constant("CONFIG",window.eis.CONFIG).config(["$httpProvider","CONFIG",function(a,b){b.dev&&b.dev.sendCredentials,a.interceptors.push("HttpInterceptor")}]).config(["CONFIG","$translateProvider",function(a,b){b.preferredLanguage(a.defaults.locale),b.useLocalStorage(),b.useSanitizeValueStrategy("escaped"),b.useStaticFilesLoader({prefix:"app/i18n/locale-",suffix:".json"})}]).config(["CONFIG","$urlRouterProvider",function(a,b){b.otherwise("/"+a.defaults.state)}]).config(["$logProvider",function(a){a.debugEnabled(!0)}]).config(["CONFIG","LoadingServiceProvider",function(a,b){b.setTimeout(a.defaults.http.timeout)}]).config(function(){Chart.defaults.global.animation=!1,Chart.defaults.global.maintainAspectRatio=!0}).config(["uiZeroclipConfigProvider",function(a){a.setZcConf({swfPath:"../../vendor/zeroclipboard/dist/ZeroClipboard.swf"})}]).run(["$httpDecorator",function(a){a.decorate()}]),angular.element(document).ready(function(){angular.bootstrap(document,["eis"])})}(),function(){"use strict";angular.module("eis").controller("AppController",["CONFIG","$scope","$rootScope","$state","$translate","$sce","$log","LoadingService","NotificationService",function(a,b,c,d,e,f,g,h,i){var j=this,k=g.getInstance("AppController");j.spinner=h.loading,j.title=a.title,j.page={layout:{},title:"",description:a.description||""},j.locale={current:a.defaults.locale||"de",use:function(a){e.use(a)}},c.$on("$httpInterceptorError",function(a,b){b.data&&b.data.errors&&(a.preventDefault(),b.data.errors.forEach(function(a,b){i.add(a.severity,"error.business."+a.messageKey)}))}),c.$on("$stateChangeStart",function(a,b,c,d,e){i.clear(),b.resolve&&(j.spinner.active=!0)}),c.$on("$stateChangeSuccess",function(b,c,d,e,f){j.page.layout=c.data&&c.data.layout?c.data.layout:{},j.page.title=c.data&&c.data.title?c.data.title:"states."+c.name+".title",j.page.description=c.data&&c.data.description?c.data.description:a.description||"",j.spinner.active=!1}),c.$on("$stateChangeError",function(a,b,c,e,f,g){k.error(g),j.spinner.active=!1,d.reload(e)}),c.$on("$translateChangeSuccess",function(a,b){j.locale.current=b.language}),b.safeHtml=function(a){return f.trustAsHtml(a)}}])}(),angular.module("eis.app-templates",["../common/directives/breadcrumb/breadcrumb-directive.tpl.html","../common/directives/series-typeahead/series-typeahead-directive.tpl.html","../common/directives/tree/tree-directive.tpl.html","../oblique/ui/notifications/notifications.tpl.html","charts/charts.tpl.html","charts/share-dialog.tpl.html","home/home.tpl.html"]),angular.module("../common/directives/breadcrumb/breadcrumb-directive.tpl.html",[]).run(["$templateCache",function(a){a.put("../common/directives/breadcrumb/breadcrumb-directive.tpl.html",'<ul class="serie-breadcrumb">\n    <li class="serie-breadcrumb-step" ng-repeat="serie in steps">\n        <a href="" ng-attr-style="color: {{serie.color}};" ng-click="showSerie(serie)">{{serie.label}}</a>\n        <span class="serie-breadcrumb-step-separator fa fa-angle-right" ng-if="!$last"></span>\n    </li>\n</ul>\n')}]),angular.module("../common/directives/series-typeahead/series-typeahead-directive.tpl.html",[]).run(["$templateCache",function(a){a.put("../common/directives/series-typeahead/series-typeahead-directive.tpl.html",'<div class="series-typeahead form-group">\n    <div class="input-group">\n        <div class="control-action">\n            <input class="series-typeahead-input form-control" type="text" placeholder="{{\'common.search.placeholder\' | translate}}" ng-model="search" ng-blur="focused = false" ng-focus="focused = true">\n            <button class="control-action-trigger" data-action="clear" tabindex="-1" ng-mousedown="focused = true; $event.preventDefault();" ng-click="clearSearch()">\n                <span class="fa fa-times-circle"></span>\n            </button>\n        </div>\n         <span class="input-group-addon">\n             <span class="fa fa-search"></span>\n        </span>\n    </div>\n    <div class="series-typeahead-results" ng-mousedown="focused = true; $event.preventDefault();" ng-init="initInfiniteScroll()" ng-if="focused && search !== \'\'">\n        <div class="series-typeahead-no-results" ng-if="searchResult.length === 0">\n            {{\'common.search.noResults\' | translate}}\n        </div>\n        <ul class="series-typeahead-items">\n            <li class="series-typeahead-item" ng-repeat="serie in searchResult | limitTo: (limit > 0 ? limit : \'\')">\n                <h4 class="series-typeahead-item-title">{{serie.label}}</h4>\n                <div class="series-typeahead-item-body">\n                    <breadcrumb ng-model="serie" tree-control="treeControl"></breadcrumb>\n                    <span class="tree-entry-control" ng-class="{\'tree-entry-control-selected\': serie.selected}" title="{{\'states.charts.tree.\' + (serie.selected !== -1 ? \'removeSerie\' : \'addSerie\') | translate}}">\n                        <input type="checkbox" ng-model="serie.selected" ng-click="serieSelected({serie: serie})">\n                        <span class="tree-entry-control-icon fa fa-area-chart"></span>\n                    </span>\n                </div>\n            </li>\n        </ul>\n    </div>\n</div>\n')}]),angular.module("../common/directives/tree/tree-directive.tpl.html",[]).run(["$templateCache",function(a){a.put("../common/directives/tree/tree-directive.tpl.html",'<ul id="level-{{level}}" ng-class="{\'tree-root\': level === \'1\'}">\n    <li ng-repeat="node in nodes">\n        <div class="tree-entry" ng-class="{\'tree-leaf\': !(node.children && node.children.length > 0)}" ng-if="node.type !== \'loader\'">\n            <a class="tree-entry-label" href="" ng-class="{\'collapsed\': !node.open}" ng-if="node.children && node.children.length > 0" data-node-id="{{node.id}}" ng-click="toggleNode(node)">\n                {{node.label}}\n            </a>\n            <span class="tree-entry-label" ng-if="!node.children || node.children.length <= 0" tabindex="0" data-node-id="{{node.id}}">\n                {{node.label}}\n            </span>\n            <span class="tree-entry-control" ng-class="{\'tree-entry-control-selected\': node.selected}" title="{{\'states.charts.tree.\' + (node.selected ? \'removeSerie\' : \'addSerie\') | translate}}">\n                <input type="checkbox" ng-model="node.selected" ng-click="nodeSelected({node: node})">\n                <span class="tree-entry-control-icon fa fa-area-chart"></span>\n            </span>\n        </div>\n        <div class="tree-entry-loader" ng-if="node.type === \'loader\'">\n            <button type="button" class="btn btn-link" ng-click="loadMore(node)">\n                ... ({{\'common.\' + (node.target === \'before\' ? \'previous\' : \'next\') | translate}}\n                <span ng-if="node.target === \'before\'">{{CHILDREN_CHUNCK_SIZE < node.node.range.from ? CHILDREN_CHUNCK_SIZE : node.node.range.from}}</span>\n                <span ng-if="node.target === \'after\'">{{CHILDREN_CHUNCK_SIZE < (node.node.children.length - node.node.range.to) ? CHILDREN_CHUNCK_SIZE : (node.node.children.length - node.node.range.to)}}</span>\n                {{\'common.of\' | translate}}\n                <span ng-if="node.target === \'before\'">{{node.node.range.from}}</span>\n                <span ng-if="node.target === \'after\'">{{node.node.children.length - node.node.range.to}}</span>)\n            </button>\n        </div>\n        <tree nodes="node._children || node.children" level="{{level}}-{{$index}}" node-selected="nodeSelected({node: node})" ng-if="node.open && node.children && node.children.length > 0"></tree>\n    </li>\n</ul>\n')}]),angular.module("../oblique/ui/notifications/notifications.tpl.html",[]).run(["$templateCache",function(a){a.put("../oblique/ui/notifications/notifications.tpl.html",'<div class="notification-container">\n	<div class="notification show">\n		<div class="{{alertType[notification.type]}} animated slide-in-right" ng-repeat="notification in notifications">\n			<button ng-click="remove(notification)" ng-show="isClosable(notification)" type="button" class="close">&times;</button>\n			<h4>\n				<span ng-if="!notification.title">{{("notification.type." + notification.type) | translate}}</span>\n				<span>{{notification.title}}</span></h4>\n			<p class="lead">{{notification.messageKey | translate}}</p>\n		</div>\n	</div>\n</div>\n')}]),angular.module("charts/charts.tpl.html",[]).run(["$templateCache",function(a){a.put("charts/charts.tpl.html",'<div class="default-layout">\n    <div class="content-header">\n        <h1>{{appController.page.title | translate}}</h1>\n        <p>{{appController.page.description | translate}}</p>\n    </div>\n    <div class="content-body">\n        <div class="row">\n            <div class="col-md-4">\n                <div class="search">\n                    <div class="search-input">\n                        <series-typeahead series="series" tree-control="treeControl" selection="selection" serie-selected="serieSelected(serie)"></series-typeahead>\n                    </div>\n                    <div class="search-collapse">\n                        <div class="btn-group" role="group">\n                            <button type="button" class="btn btn-default" ng-click="treeControl.collapseAll(false)" title="{{\'common.collapseAll\' | translate}}"><span class="fa fa-plus-square-o"></span></button>\n                            <button type="button" class="btn btn-default" ng-click="treeControl.collapseAll(true)" title="{{\'common.expandAll\' | translate}}"><span class="fa fa-minus-square-o"></span></button>\n                        </div>\n                    </div>\n                </div>\n                <div class="tree">\n                    <tree nodes="series" level="1" control="treeControl" node-selected="serieSelected(node)"></tree>\n                </div>\n            </div>\n            <div class="col-md-8">\n                <div class="selection" ng-if="selection.series.length > 0">\n                    <h3 class="selection-title">\n                        {{\'states.charts.selection.title\' | translate}} <a class="selection-share" ng-click="openShareDialog()" title="{{\'states.charts.selection.share\' | translate}}"><span class="fa fa-share-alt"></span></a>\n                    </h3>\n                    <ul class="legend">\n                        <li class="legend-entry" ng-repeat="serie in selection.series">\n                            <span class="legend-entry-label">\n                                <breadcrumb ng-model="serie" tree-control="treeControl"></breadcrumb>\n                            </span>\n                            <span class="legend-entry-controls">\n                                <span class="legend-entry-control" ng-class="{\'legend-entry-control-selected\': !serie.visible}" title="{{\'states.charts.legend.visibility\' | translate}}">\n                                    <input type="checkbox" ng-model="serie.visible" ng-click="refresh()">\n                                    <span class="legend-entry-control-icon fa fa-eye"></span>\n                                </span>\n                                <span class="legend-entry-control" title="{{\'states.charts.legend.remove\' | translate}}">\n                                    <input type="checkbox" ng-model="serie.selected" ng-click="serieSelected(serie)">\n                                    <span class="legend-entry-control-icon fa fa-trash-o"></span>\n                                </span>\n                            </span>\n                        </li>\n                    </ul>\n                </div>\n                <div class="chart-no-data" ng-if="selection.series.length <= 0">\n                    <div class="chart-no-data-text" ng-bind-html="\'states.charts.noData\' | translate">\n                    </div>\n                </div>\n                <div class="panel panel-default" ng-if="selection.series.length > 0">\n                    <div class="panel-heading">\n                        <h3 class="panel-title">\n                            {{appController.page.title | translate}}\n                        </h3>\n                    </div>\n                    <div class="panel-body">\n                        <canvas class="chart-base" chart-type="chartjsConfig.type"\n                                data="chartjsConfig.data" labels="chartjsConfig.labels" series="chartjsConfig.series"\n                                legend="false" click="onClick" colours="chartjsConfig.colors" options="chartjsConfig.options">\n                        </canvas>\n                    </div>\n                    <div class="panel-footer">\n                        <label>{{\'states.charts.chart.timeRange\' | translate}}</label>\n                        <range-slider min="{{range.min}}" max="{{range.max}}" step="1" ng-model="range.current"></range-slider>\n                    </div>\n                    <div class="panel-footer">\n                        <label>{{\'states.charts.chart.representation\' | translate}}</label>\n                        <div class="radio radio-inline">\n                            <div class="radio">\n                                <input type="radio" ng-model="chartjsConfig.type" value="Line" id="chart-type-line">\n                                <label for="chart-type-line">{{\'states.charts.chart.lines\' | translate}}</label>\n                            </div>\n                            <div class="radio">\n                                <input type="radio" ng-model="chartjsConfig.type" value="Bar" id="chart-type-bar">\n                                <label for="chart-type-bar">{{\'states.charts.chart.bars\' | translate}}</label>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),angular.module("charts/share-dialog.tpl.html",[]).run(["$templateCache",function(a){a.put("charts/share-dialog.tpl.html",'<div class="modal-header">\n    <button class="close" aria-hidden="true" type="button" ng-click="cancel()">×</button>\n    <h4 class="modal-title">\n        <span>{{\'states.charts.selection.shareTitle\' | translate}}</span>\n    </h4>\n</div>\n<div class="modal-body">\n    <div class="share-title">\n        <div class="checkbox">\n            <input id="check-all" type="checkbox" ng-model="allSelected" ng-click="toggleAll(allSelected)">\n            <label for="check-all">{{\'common.collapseExpandAll\' | translate}}</label>\n        </div>\n    </div>\n    <ul class="share-series">\n        <li class="share-serie" ng-repeat="serie in series">\n            <div class="checkbox">\n                <input id="serie_{{serie.id}}" type="checkbox" ng-model="serie.share" ng-click="checkValidity()">\n                <label for="serie_{{serie.id}}">{{serie.label}}</label>\n            </div>\n        </li>\n    </ul>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-link" type="button" ng-click="cancel()">{{ \'common.cancel\' | translate }}</button>\n    <button class="btn btn-default" type="button" ui-zeroclip zeroclip-copied="copied=true" zeroclip-model="getUrl()" ng-disabled="!valid">{{ \'common.copy\' | translate }}</button>\n    <a class="btn btn-default" href="mailto:?Subject={{\'application.longName\' | translate}}&Body={{getUrl()}}" ng-if="valid">{{\'common.sendEmail\' | translate}}</a>\n    <a class="btn btn-default" disabled="disabled" ng-if="!valid">{{\'common.sendEmail\' | translate}}</a>\n</div>\n')}]),angular.module("home/home.tpl.html",[]).run(["$templateCache",function(a){a.put("home/home.tpl.html",'<div class="application-content-viewport">\n    <div class="default-layout">\n        <div class="headline headline-lg">\n            <h1>\n                <span>{{\'application.longName\' | translate}}</span>\n            </h1>\n            <p class="lead">{{\'application.description\' | translate}}</p>\n        </div>\n        <div class="row">\n            <div class="col-md-3">\n                <div class="thumbnail">\n                    <h2 class="thumbnail-title">{{\'states.generalBudget.title\' | translate}}</h2>\n                    <ul class="thumbnail-links">\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="generalBudget.institution">{{\'states.common.depends.institution\' | translate}}</a>\n                        </li>\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="generalBudget.type">{{\'states.common.depends.type\' | translate}}</a>\n                        </li>\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="generalBudget.responsabilities">{{\'states.common.depends.responsabilities\' | translate}}</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n\n            <div class="col-md-3">\n                <div class="thumbnail">\n                    <h2 class="thumbnail-title">{{\'states.revenue.title\' | translate}}</h2>\n                    <ul class="thumbnail-links">\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="revenue.institution">{{\'states.common.depends.institution\' | translate}}</a>\n                        </li>\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="revenue.type">{{\'states.common.depends.type\' | translate}}</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n\n            <div class="col-md-3">\n                <div class="thumbnail">\n                    <h2 class="thumbnail-title">{{\'states.expenses.title\' | translate}}</h2>\n                    <ul class="thumbnail-links">\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="expenses.institution">{{\'states.common.depends.institution\' | translate}}</a>\n                        </li>\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="expenses.type">{{\'states.common.depends.type\' | translate}}</a>\n                        </li>\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="expenses.responsabilities">{{\'states.common.depends.responsabilities\' | translate}}t</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n\n            <div class="col-md-3">\n                <div class="thumbnail">\n                    <h2 class="thumbnail-title">{{\'states.institutions.title\' | translate}}</h2>\n                    <ul class="thumbnail-links">\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="institutions.departements">{{\'states.common.depends.departements\' | translate}}</a>\n                        </li>\n                        <li class="thumbnail-link">\n                            <a class="btn btn-default" ui-sref="institutions.administrativeUnits">{{\'states.common.depends.administrativeUnits\' | translate}}</a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n')}]),function(){"use strict";angular.module("eis.common",[]).filter("asDate",["$filter",function(a){return function(b){return b?a("date")(new Date(b),"dd.MM.yyyy"):b}}]).filter("asLongDate",["$filter",function(a){return function(b){return b?a("date")(new Date(b),"EEEE d MMMM yyyy"):b}}]).filter("asMediumDate",["$filter",function(a){return function(b){return b?a("date")(new Date(b),"EEE, d MMM yyyy"):b}}]).filter("asLongMonth",["$filter",function(a){return function(b){return b?a("date")(new Date(b),"MMMM yyyy"):b}}]).filter("asDateTime",["$filter",function(a){return function(b){return b?a("date")(new Date(b),"dd.MM.yyyy HH:mm"):b}}])}(),function(){"use strict";var a=angular.module("eis.common");a.directive("rangeSlider",function(){return{restrict:"E",scope:{ngModel:"=ngModel",min:"@",max:"@",step:"=step"},template:'<div ui-slider="sliderOptions" min="{{min}}" max="{{max}}" step="{{step}}" ng-model="ngModel"></div>',link:function(a,b,c){a.sliderOptions={range:!0,slide:function(b,c){a.setupTooltip(b,c)},change:function(b,c){a.setupTooltip(b,c)}},a.setupTooltip=function(a,b){$(b.handle).html('<div class="range-slider-tooltip">'+b.value+"</div>")}}}})}(),function(){"use strict";var a=angular.module("eis.common");a.directive("tree",["RecursionHelper","$timeout",function(a,b){function c(a){a.children&&a.children.length>0&&(a.range={from:0,to:l>0?l:a.children.length},d(a))}function d(a){a.range.from=a.range.from>=0?a.range.from:0,a.range.to=a.range.to<a.children.length?a.range.to:a.children.length}function e(a,b,d){a.open=!0,a.range||c(a),a.range&&k(a,b,d)}function f(a){a.open=!1,c(a),a.children&&angular.forEach(a.children,function(a){f(a)})}function g(a,b,c){angular.forEach(a,function(a){a.children&&(b?f(a):e(a,null,c),g(a.children,b,c))})}function h(a){var b,c,d={total:0};for(b=1;l>b;b++)if(d.total=0,c=i(a,b,d,0),c>n)return b-1>0?b-1:l;return l}function i(a,b,c,d){var e,f=0===d?a.length:b;for(e=0;f>e&&e<a.length;e++)c.total++,a[e].children&&i(a[e].children,b,c,d+1);return c.total}function j(a){a.parent&&(e(a.parent,a),j(a.parent))}function k(a,b,c){var e,f;b?(f=a.children.indexOf(b),a.range.from=m>0?f-m:0,a.range.to=m>0?f+m+1:a.children.length,d(a)):c&&(a.range.from=0,a.range.to=c),e=a.range.to-a.range.from,a.children&&a.children.length>e?(a._children=a.children.slice(a.range.from,a.range.to),a._children.length<a.children.length&&(a.range.from>0&&a._children.unshift({type:"loader",target:"before",node:a}),a.range.to<a.children.length&&a._children.push({type:"loader",target:"after",node:a}))):a._children=a.children}var l=10,m=2,n=200;return{restrict:"E",scope:{nodes:"=",level:"@",control:"=",nodeSelected:"&"},templateUrl:"../common/directives/tree/tree-directive.tpl.html",compile:function(c){return a.compile(c,function(a,c,i,m,o){a.internalControl=a.control||{},a.CHILDREN_CHUNCK_SIZE=l,a.toggleNode=function(a){a.open?f(a):e(a)},a.loadMore=function(a){"before"===a.target&&(a.node.range.from-=l),"after"===a.target&&(a.node.range.to+=l),d(a.node),k(a.node)},a.internalControl.collapseAll=function(b){var c;!b&&n>0&&(c=h(a.nodes)),g(a.nodes,b,c)},a.internalControl.showSerie=function(d){g(a.nodes,!0),j(d),b(function(){var a=c.find('[data-node-id="'+d.id+'"]');a.focus(),$("html, body").scrollTo=a.offset().top})}})}}}])}(),function(){"use strict";var a=angular.module("eis.common");a.directive("breadcrumb",function(){return{restrict:"E",scope:{ngModel:"=",treeControl:"="},templateUrl:"../common/directives/breadcrumb/breadcrumb-directive.tpl.html",controller:["$scope",function(a){var b=a.ngModel;for(a.steps=[];null!==b;)a.steps.push(b),b=b.parent;a.steps.reverse(),a.showSerie=function(b){a.treeControl.showSerie(b)}}],link:function(a,b,c){}}})}(),function(){"use strict";var a=angular.module("eis.common");a.directive("seriesTypeahead",["$timeout",function(a){function b(a,c,d){""!==c&&angular.forEach(a,function(a){0===a.label.toLowerCase().indexOf(c.toLowerCase())&&d.push(a),a.children&&b(a.children,c,d)})}var c=20,d=100;return{restrict:"E",scope:{series:"=",treeControl:"=",serieSelected:"&"},templateUrl:"../common/directives/series-typeahead/series-typeahead-directive.tpl.html",controller:["$scope","$element",function(a,d){a.search="",a.searchResult=[],a.focused=!1,a.limit=c,a.clearSearch=function(){a.search=""},a.$watch("search",function(e,f){e!==f&&(a.limit=c,a.searchResult=[],d.find(".series-typeahead-results").scrollTop(0),b(a.series,e,a.searchResult))}),a.paging=function(){a.limit+=c}}],link:function(b,e,f){b.initInfiniteScroll=function(){var f=e.find(".series-typeahead-results");b.limit=c,f.scroll(function(){var c=f.height(),e=f.find(".series-typeahead-items").height(),g=f.scrollTop();d>=e-c-g&&a(function(){b.paging()},0)})}}}}])}(),function(){"use strict";angular.module("eis.oblique",[])}(),function(){"use strict";angular.module("eis.oblique").config(["$provide",function(a){a.decorator("$log",["CONFIG","$delegate","$injector",function(a,b,c){function d(a,d){return function(){var g=[].slice.call(arguments),h=new Date+" - ["+d+"]";if(h+=g[0]&&g[0]instanceof Error?g[0].message:JSON.stringify(g),b[a](h),f&&!e(g)){var i=c.get("$http");i.api.post(f,{level:a,message:h,silent:!0})}}}function e(a){return a&&a[0]&&a[0].config&&a[0].config.url&&a[0].config.url.indexOf(f)>-1}b.getInstance=function(a){return{log:d("log",a),info:d("info",a),warn:d("warn",a),error:d("error",a),debug:d("debug",a)}};var f=a.api&&a.api.logs;return b}])}])}(),function(){"use strict";angular.module("eis.oblique").factory("$httpDecorator",["CONFIG","$http",function(a,b){function c(a){return function(){var c=[].slice.call(arguments);return c[0]=b.api.url+c[0],a.apply(null,c).then(function(a){return a.data})}}return{decorate:function(){b.api=b.api||{},b.api.url=a.api.schema+"://"+a.api.hostname+":"+a.api.port+a.api.context,b.api.head=c(b.head),b.api.get=c(b.get),b.api.post=c(b.post),b.api.put=c(b.put),b.api["delete"]=c(b["delete"]),b.api.patch=c(b.patch),b.api.isApiCall=function(a){return a.indexOf(b.api.url)>-1}}}}])}(),function(){"use strict";angular.module("eis.oblique").factory("HttpInterceptor",["CONFIG","$q","$log","$injector","$rootScope","NotificationService","LoadingService",function(a,b,c,d,e,f,g){function h(a){return l(a)||m(a)||!n().api.isApiCall(a.url)||g.start(),a}function i(a){return b.reject(a)}function j(a){var b=n();return b.api.isApiCall(a.config.url)&&g.stop(),a}function k(a){var c=n();return c.api.isApiCall(a.config.url)&&g.stop(),e.$broadcast("$httpInterceptorError",a).defaultPrevented||!l(a.config)&&(a.status>=500||0===a.status)&&(a.defaultPrevented=!0,f.error("error.http.status."+a.status)),o.error(a),b.reject(a)}function l(a){return a&&(a.silent||a.data&&a.data.silent)}function m(a){return a&&(a.background||a.data&&a.data.background)}function n(){return d.get("$http")}var o=c.getInstance("HttpInterceptor");return{request:h,requestError:i,response:j,responseError:k}}])}(),function(){"use strict";angular.module("eis.oblique").config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","$injector",function(a,b){var c=b.get("$log").getInstance("$exceptionHandler");return function(a,b){c.error(a,b)}}])}])}(),function(){"use strict";angular.module("eis.oblique").config(["$provide",function(a){a.decorator("$state",["$delegate","$stateParams",function(a,b){return a.forceReload=function(c){return a.go(c||a.current,b,{reload:!0,inherit:!1,notify:!0})},a}])}])}(),function(){"use strict";angular.module("eis.oblique").provider("LoadingService",function(){var a=1e4;return{setTimeout:function(b){a=b},$get:["$log","$timeout","NotificationService",function(b,c,d){function e(){var b=h;g.push({id:h,timeout:c(function(){var a=g.filter(function(a){return a.id===b});"undefined"!=typeof a&&(f(),d.error("error.other.timeout"))},a)}),h++,i.active=g.length>0}function f(){g.length<=0||(c.cancel(g.shift().timeout),i.active=g.length>0)}var g=[],h=0,i={active:!1};return{loading:i,start:e,stop:f}}]}})}(),function(){"use strict";angular.module("eis.oblique").directive("notifications",["NotificationService",function(a){return{restrict:"AE",templateUrl:"../oblique/ui/notifications/notifications.tpl.html",replace:!0,scope:!1,controller:["$scope","$element","$attrs",function(b,c,d){b.notifications=a.notifications,b.alertType={"default":"alert",info:"alert alert-info",success:"alert alert-success",warning:"alert alert-warning",error:"alert alert-danger"},b.isClosable=function(a){return a.sticky},b.remove=function(b){a.remove(b.id)}}],link:function(a,b,c){}}}])}(),function(){"use strict";angular.module("eis.oblique").provider("NotificationService",function(){var a=5e3,b=[],c={"default":{priority:0},info:{priority:1},success:{priority:2},warning:{priority:3},error:{priority:4}},d=function(a,b){return c[a.type].priority<c[b.type].priority};return{setTimeout:function(b){a=b},$get:["$timeout",function(c){var e=0,f={};return f.notifications=b,f.add=function(g,h,i,j){var k={id:e,type:g,messageKey:h,title:i,sticky:"error"===g||j};b.unshift(k),b.sort(d),k.sticky||c(function(){f.remove(k.id)},a),e++},f.remove=function(a){b.forEach(function(c,d){a===c.id&&b.splice(d,1)})},f.clear=function(){b.length=0},f["default"]=function(a,b,c){return f.add("default",a,b,c)},f.info=function(a,b,c){return f.add("info",a,b,c)},f.success=function(a,b,c){return f.add("success",a,b,c)},f.warn=function(a,b,c){return f.add("warning",a,b,c)},f.warning=f.warn,f.error=function(a,b,c){return f.add("error",a,b,c)},f}]}})}(),function(){"use strict";angular.module("eis.home",["ui.router"]).config(["$stateProvider",function(a){a.state("home",{url:"/home",templateUrl:"home/home.tpl.html",controller:"HomeController",data:{description:"states.home.description"}})}])}(),function(){"use strict";angular.module("eis.home").controller("HomeController",["$scope","$state",function(a,b){}])}(),function(){"use strict";angular.module("eis.charts",["ui.router"])}(),function(){"use strict";angular.module("eis.charts").controller("ChartsController",["$scope","$stateParams","$location","$modal","$q","ChartsService","structureId",function(a,b,c,d,e,f,g){function h(b){return i(a.series,b)}function i(a,b){var c=null;return angular.forEach(a,function(a){a.id===b&&(c=a),!c&&a.children&&(c=i(a.children,b))}),c}a.structureId=g,a.series=f.series,a.range=f.range,a.treeControl={},a.chartjsConfig={type:"Line",labels:[],series:[],data:[],colors:[],options:{bezierCurve:!1,datasetFill:!1}},a.selection={series:[]};var j=b.series;j=j?j.split(","):[],angular.forEach(j,function(b){var c=h(b);c&&(a.selection.series.push(c),c.selected=!0)}),a.serieSelected=function(b){b.selected?a.selection.series.push(b):a.selection.series.splice(a.selection.series.indexOf(b),1),a.refresh()},a.refresh=function(){var b=[],d=[];a.chartjsConfig.series.length=0,angular.forEach(a.selection.series,function(b){a.chartjsConfig.series.push(b.title)}),a.chartjsConfig.labels=f.getLabels(),a.chartjsConfig.data.length=0,a.chartjsConfig.colors.length=0,angular.forEach(a.selection.series,function(c){b.push(c.id),d.push(f.getData(a.structureId,c.id).then(function(b){var d=c.visible?c.color:"rgba(255, 255, 255, 0)";a.chartjsConfig.colors.push({strokeColor:d,pointColor:d,pointStrokeColor:d}),a.chartjsConfig.data.push(b)}))}),e.all(d).then(function(){}),c.search({series:b.length>0?b.join(","):null})},a.$watchGroup(["range.current"],a.refresh),a.openShareDialog=function(){var b=d.open({templateUrl:"charts/share-dialog.tpl.html",controller:"ShareDialogController",backdrop:"static",resolve:{series:function(){return a.selection.series}}});return b},a.onClick=function(a,b){console.log(a)}}])}(),function(){"use strict";var a=angular.module("eis.charts");a.factory("ChartsResource",["$http",function(a){return{getStructure:function(b){return a.get("./data/"+b+"-structure.json");
},getData:function(b,c){return a.get("./data/"+b+"-data-"+c+".json")}}}])}(),function(){"use strict";var a=angular.module("eis.charts");a.factory("ChartsService",["$q","ChartsResource",function(a,b){var c={_years:[],_seriesData:{},range:{min:0,max:0,current:[1980,1995]},series:{},_setUpSeries:function(a,b,d){angular.forEach(a,function(a,e){a.parent=b,a.level=d,a.visible=!0,a.selected=!1,a.color=c._generateRandomColor(),a.open=!1,a.children&&c._setUpSeries(a.children,a,d+"-"+e)})},_setUp:function(){var a,b;for(c.range.min=c.series.range.from,c.range.max=c.series.range.to,c._years=[],c.series=c.series.structure.children,c._setUpSeries(c.series,null,"1"),c._years=[],a=c.range.min,b=c.range.max+1;b>a;a++)c._years.push(a);(c.range.current[0]<c.range.min||c.range.current[0]>c.range.max)&&(c.range.current[0]=c.range.min),(c.range.current[1]>c.range.max||c.range.current[1]<c.range.min)&&(c.range.current[1]=c.range.max)},_getValues:function(a){var b=[];return angular.forEach(c._years,function(c){var d=a[c]?a[c]:null;d&&"string"==typeof d&&(d=parseInt(d,10)),b.push(d)}),b},_generateRandomColor:function(){var a,b="0123456789ABCDEF".split(""),c="#";for(a=0;6>a;a++)c+=b[Math.floor(16*Math.random())];return c},_range:function(a){var b=c._years.indexOf(c.range.current[0]),d=c._years.indexOf(c.range.current[1])+1;return a.slice(b,d)},_compress:function(a,b){var c,d,e=[];for(d=(a.length-1)/(b-1),c=0;b>c;c++)e.push(a[Math.round(c*d)]);return e},_prepare:function(a,b){var d=c._range(a);return b&&d.length>b&&(d=c._compress(d,b)),d},init:function(a){return b.getStructure(a).then(function(a){c.series=a.data,c._setUp()})},getData:function(d,e){var f=c._structureId+"-"+e;return a(function(a,g){var h=c._seriesData[f];h?a(c._prepare(h)):b.getData(d,e).then(function(b){var d=c._getValues(b.data.data);c._seriesData[f]=d,a(c._prepare(d))},function(a){g(a)})})},getLabels:function(){return c._prepare(c._years)}};return c}])}(),function(){"use strict";angular.module("eis.charts").controller("ShareDialogController",["$scope","$modalInstance","$location","series",function(a,b,c,d){function e(){g(!0)}function f(){g(!1)}function g(b){angular.forEach(a.series,function(a){a.share=b}),a.checkValidity()}a.series=d.slice(0),a.allSelected=!0,a.valid=!1,a.toggleAll=function(a){a?e():f()},a.getUrl=function(){var b=[];return angular.forEach(a.series,function(a){a.share&&b.push(a.id)}),c.absUrl().split("?")[0]+"?series="+b.join(",")},a.cancel=function(){b.dismiss("cancel")},a.checkValidity=function(){a.valid=!1,angular.forEach(a.series,function(b){b.share&&(a.valid=!0)})},e()}])}(),function(){"use strict";var a="000",b="000",c="041b";angular.module("eis.expenses",["ui.router"]).config(["$stateProvider",function(d){d.state("expenses",{"abstract":!0,url:"/expenses",template:'<div ui-view class="application-content-viewport"></divui-view>',data:{description:"states.expenses.description"}}).state("expenses.institution",{url:"/institution?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return a},chartConf:["ChartsService",function(b){return b.init(a)}]}}).state("expenses.type",{url:"/type?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return b},chartConf:["ChartsService",function(a){return a.init(b)}]}}).state("expenses.responsabilities",{url:"/responsabilities?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return c},chartConf:["ChartsService",function(a){return a.init(c)}]}})}])}(),function(){"use strict";var a="000",b="000",c="000";angular.module("eis.generalBudget",["ui.router"]).config(["$stateProvider",function(d){d.state("generalBudget",{"abstract":!0,url:"/generalBudget",template:'<div ui-view class="application-content-viewport"></divui-view>',data:{description:"states.generalBudget.description"}}).state("generalBudget.institution",{url:"/institution?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return a},chartConf:["ChartsService",function(b){return b.init(a)}]}}).state("generalBudget.type",{url:"/type?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return b},chartConf:["ChartsService",function(a){return a.init(b)}]}}).state("generalBudget.responsabilities",{url:"/responsabilities?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return c},chartConf:["ChartsService",function(a){return a.init(c)}]}})}])}(),function(){"use strict";var a="000",b="000";angular.module("eis.institutions",["ui.router"]).config(["$stateProvider",function(c){c.state("institutions",{"abstract":!0,url:"/institutions",template:'<div ui-view class="application-content-viewport"></divui-view>',data:{description:"states.institutions.description"}}).state("institutions.departements",{url:"/departements?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return a},chartConf:["ChartsService",function(b){return b.init(a)}]}}).state("institutions.administrativeUnits",{url:"/administrativeUnits?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return b},chartConf:["ChartsService",function(a){return a.init(b)}]}})}])}(),function(){"use strict";var a="000",b="000";angular.module("eis.revenue",["ui.router"]).config(["$stateProvider",function(c){c.state("revenue",{"abstract":!0,url:"/revenue",template:'<div ui-view class="application-content-viewport"></divui-view>',data:{description:"states.revenue.description"}}).state("revenue.institution",{url:"/institution?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return a},chartConf:["ChartsService",function(b){return b.init(a)}]}}).state("revenue.type",{url:"/type?series",templateUrl:"charts/charts.tpl.html",controller:"ChartsController",reloadOnSearch:!1,resolve:{structureId:function(){return b},chartConf:["ChartsService",function(a){return a.init(b)}]}})}])}();